document.addEventListener("DOMContentLoaded",(function(t){function e(t){alert(t)}function a(t,a,n,o,i){data={type:t,type_id:a,pageCmt:n},$.ajax({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},type:"POST",url:variable.ajax_load_url,data:data,beforeSend:function(){$(".comments-loading").css({visibility:"visible",opacity:0}).animate({opacity:1},200)},success:function(t){$(".comments-loading").animate({opacity:0},200,(function(){$(".comments-loading").css("visibility","hidden")})),o.closest(".comments").find(".total-comment").text(t.comment_totals),$(".comments").find(".total-comment").text("("+t.comment_totals+") đánh giá"),$(".comments").find(".block-rate__chart").html(t.chart),0==t.has_more?o.closest(".comments").find(".comments-loadmore").css("display","none"):o.closest(".comments").find(".comments-loadmore").css("display","block"),1==i?o.closest(".comments").find(".comments-list").empty().append(t.html):o.closest(".comments").find(".comments-list").append(t.html),o.closest(".comments").find("*[data-comments_loadmore]").data("page_cmt",n).attr("data-page_cmt",n),o.closest(".comments").find(".comments-info__filter").find("input[name=keyword]").val("")},error:function(t){$(".comments-loading").animate({opacity:0},200,(function(){$(".comments-loading").css("visibility","hidden")})),e(variable.ajax_load_error_text)}})}function n(t,a,n,o,i,m){data={type:t,type_id:a,keyword:n,pageCmt:o},$.ajax({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},type:"POST",url:variable.ajax_search_url,data:data,beforeSend:function(){$(".comments-loading").css({visibility:"visible",opacity:0}).animate({opacity:1},200)},success:function(t){$(".comments-loading").animate({opacity:0},200,(function(){$(".comments-loading").css("visibility","hidden")})),0==t.has_more?i.closest(".comments").find(".comments-loadmore").css("display","none"):i.closest(".comments").find(".comments-loadmore").css("display","block"),1==m?i.closest(".comments").find(".comments-list").empty().append(t.html):i.closest(".comments").find(".comments-list").append(t.html),i.closest(".comments").find("*[data-comments_loadmore]").data("page_cmt",o).attr("data-page_cmt",o)},error:function(t){$(".comments-loading").animate({opacity:0},200,(function(){$(".comments-loading").css("visibility","hidden")})),e(variable.ajax_load_error_text)}})}$(document).ready((function(){variable=$(".lang_comments").data("value"),variable=atob(variable),variable=JSON.parse(variable),$("body").on("click",".comments .action_like",(function(t){let e=$(this).data("id");var a=$(".qty_like_"+e);data={id:e},$.ajax({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},type:"POST",url:variable.ajax_like,data:data,success:function(t){a.html(t)},error:function(t){}})})),$("body").on("click",".acition_hidden",(function(t){$(".item-reply").find(".comments-add").css("display","none")})),$("body").on("click",".comments-content .pagination a",(function(t){t.preventDefault(),href=$(this).attr("href"),type=$(this).closest(".comments").data("type"),type_id=$(this).closest(".comments").data("type_id");var e=getUrlParameter(href,"pageCmt");a(type,type_id,e,$(this),1)})),$("body").on("click",".comments *[data-comments_loadmore]",(function(t){t.preventDefault(),t.stopImmediatePropagation(),type=$(this).closest(".comments").data("type"),type_id=$(this).closest(".comments").data("type_id"),pageCmt=parseInt($(this).data("page_cmt")),pageCmt+=1,""==$(this).closest(".comments").find(".comments-info__filter").find("input[name=keyword]").val()?a(type,type_id,pageCmt,$(this)):(value=$(this).closest(".comments").find(".comments-info__filter").find("input[name=keyword]").val(),n(type,type_id,value,pageCmt,$(this),!1))})),start=null,$("body").on("click",".comments-info__filter button[type=submit]",(function(t){t.preventDefault(),t.stopImmediatePropagation(),t=$(this),clearTimeout(start),comments=t.closest(".comments"),type=comments.data("type"),type_id=comments.data("type_id"),value=t.closest(".comments-info__filter").find("input[name=keyword]").val(),n(type,type_id,value,1,t,!0)})),$("body").on("keyup",".comments-info__filter input[name=keyword]",(function(t){t.preventDefault(),t.stopImmediatePropagation(),t=$(this),clearTimeout(start),value=t.val(),start=setTimeout((function(){t.closest(".comments-info__filter").find("button[type=submit]").click()}),2e3)})),$("body").on("click",".comments *[data-reply]",(function(t){t.preventDefault(),t.stopImmediatePropagation(),item=$(this).closest(".item[data-comment_id]"),tags=$(this).data("reply"),$(".item-reply").find(".comments-add").css("display","none"),$(".comments-add__moreinfo").css("display","none"),item.find(".item-reply").find(".comments-add").slideDown(),item.find(".item-reply").find(".comments-add").find(".comments-add__form-field").val(tags)})),$(".comments-add__rate .star svg").on("click",(function(t){currentValue=$(this).attr("evaluate"),$(this).closest(".comments-add__rate").find(".rank").val(currentValue);var e=$(".comments-add__rate .rating svg");$(e).removeClass("active"),$(e).find("path").addClass("active");for(var a=0;a<e.length;a++){$(e[a]).attr("evaluate")<=currentValue&&($(e[a]).addClass("active"),$(e[a]).attr("fill","#fd9727"),e.find("path").attr("stroke","#fd9727"))}})),$(".comments-add__rate .star svg").hover((function(){currentValue=$(this).attr("evaluate");for(var t=$(".comments-add__rate .rating svg"),e=0;e<t.length;e++){var a=$(t[e]).attr("evaluate");t.find("path").attr("stroke","#fd9727"),a<=currentValue&&$(t[e]).attr("fill","#fd9727")}}),(function(){var t=$(".comments-add__rate .rating svg");t.attr("fill","none"),t.find("path").attr("stroke","#111")})),$("body").on("click",".comments *[data-comments_submit]",(function(t){t.preventDefault(),t.stopImmediatePropagation(),comments=$(this).closest(".comments"),type=comments.data("type"),type_id=comments.data("type_id"),name=$(this).closest(".comments-add").find("*[name=name]").val(),phone=$(this).closest(".comments-add").find("*[name=phone]").val(),email=$(this).closest(".comments-add").find("*[name=email]").val(),content=$(this).closest(".comments-add").find("*[name=content]").val(),parent_id=$(this).closest(".comments-add").find("*[name=parent_id]").val(),rank=$(this).closest(".comments-add").find("*[name=rank]").val()??0,0==rank&&$(this).closest(".comments-add__form").find(".star_req").show(),""==content||""==name||""==phone||""==email?e(variable.valid_empty):function(t){var e=!1;""!=(t=(t=(t=(t=(t=t.trim()).replace("(+84)","0")).replace("+84","0")).replace("0084","0")).replace(/ /g,""))&&(e=t.length>=9&&t.length<=11);return e}(phone)?function(t){return/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(String(t).toLowerCase())}(email)?(form_data=new FormData,form_data.append("type",type),form_data.append("type_id",type_id),form_data.append("content",content),form_data.append("name",name),form_data.append("phone",phone),form_data.append("email",email),form_data.append("parent_id",parent_id),form_data.append("rank",rank),function(t,n,o,i){$.ajax({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},type:"POST",url:variable.ajax_add_url,data:i,enctype:"multipart/form-data",processData:!1,contentType:!1,beforeSend:function(){$(".comments-loading").css({visibility:"visible",opacity:0}).animate({opacity:1},200)},success:function(i){$(".comments-loading").animate({opacity:0},200,(function(){$(".comments-loading").css("visibility","hidden")})),2==i.status?e(i.message):(a(t,n,1,o,!0),o.closest(".comments").find("*[name=content]").val(""),o.closest(".comments").find("*[name=name]").val(""),o.closest(".comments").find("*[name=phone]").val(""),o.closest(".comments").find("*[name=email]").val(""),o.closest(".comments").find("*[name=parent_id]").val(""),o.closest(".comments").find("*[data-page_cmt]").attr("data-page_cmt",1).data("page_cmt",1),$("body").css("overflow","auto"))},error:function(t){$(".comments-loading").animate({opacity:0},200,(function(){$(".comments-loading").css("visibility","hidden")})),e(variable.ajax_load_error_text)}})}(type,type_id,$(this),form_data)):e(variable.valid_format_email):e(variable.valid_format_phone)}))}))}));
